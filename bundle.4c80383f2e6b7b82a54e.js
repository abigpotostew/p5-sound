(()=>{"use strict";const t=()=>{let t="0123456789ABCDEF";return Array(64).fill(0).map((n=>t[Math.random()*t.length|0])).join("")};class n{constructor(n){if(n=(n=new URLSearchParams(window.location.search).get("hash")||n?.toString()||t()).toUpperCase(),!new RegExp("[0-9A-F]{64}").test(n))throw console.error("Bad hash",n),Error("Bad hash: "+n);this.useA=!1;let e=function(t){let n=parseInt(t.substring(0,8),16),e=parseInt(t.substring(8,8),16),r=parseInt(t.substring(16,8),16),o=parseInt(t.substring(24,8),16);return function(){n|=0,e|=0,r|=0,o|=0;let t=(n+e|0)+o|0;return o=o+1|0,n=e^e>>>9,e=r+(r<<3)|0,r=r<<21|r>>>11,r=r+t|0,(t>>>0)/4294967296}};this.prngA=new e(n.substring(2,32)),this.prngB=new e(n.substring(34,32));for(let t=0;t<1e6;t+=2)this.prngA(),this.prngB();this.grand=()=>(this.useA=!this.useA,this.useA?this.prngA():this.prngB())}random(t,n){return void 0===t&&void 0===n?this.grand():void 0===n&&void 0!==t?this.grand()*t:this.grand()*(n-t)+t}boolean(){return this.grand>=.5}randomInt(t,n){if(void 0===t&&void 0===n)throw new Error("randomInt requires two arguments");return void 0===n?Math.floor(this.random(t+1)):Math.floor(this.random(t,n+1))}randomList(t){return t[this.randomInt(0,t.length-1)]}randomWeighted(t){const n=Array.from(t.keys()),e=n.reduce(((n,e)=>n+t.get(e)),0);let r=0;const o=n.map((n=>{const o=t.get(n)/e,s={key:n,value:o+r};return r+=o,s})),s=this.random();return o.find((({key:t,value:n})=>s<=n)).key}}const e=()=>new n,r=(t,n)=>{if("object"!=typeof n)throw new Error("attributes should be an object");window[t]={...n}},o=(t,n=0,e=1)=>{const r=(t-n)/(e-n);return r<.5?"Low":r<.75?"Medium":"High"};(()=>{const n=()=>{window.location="?hash="+t()};window.addEventListener("touchend",(function(){n()})),document.addEventListener("keyup",(t=>{" "===t.key&&n()}))})(),new p5((t=>{const{traits:n,attributes:s}=(t=>{const n=t.randomWeighted(new Map([["COMPLIMENT",.5],["ANALOGOUS",.5],["TRIADIC",.25]]));let e;e="COMPLIMENT"===n?180:"ANALOGOUS"===n?60:120;const{hue:r,saturation:s,lightness:a}={hue:t.randomInt(0,360),saturation:t.randomInt(50,100),lightness:t.randomInt(50,100)},{fgHue:i,fgSaturation:d,fgLightness:h}={fgHue:(r+e)%360,fgSaturation:Math.min(s+(t.randomInt(10)-t.randomInt(10)),100),fgLightness:Math.min(a+(t.randomInt(10)-t.randomInt(10)),100)},u=t.randomInt(10,40),g=t.randomInt(2,10),l={"Background Lightness":o(a,0,100),"Foreground Brightness":o(h,0,100),"Number of Lines":o(u,10,290),Layers:o(g,1,5)},c={bgHue:r,bgSaturation:s,bgLightness:a,fgHue:i,fgSaturation:d,fgLightness:h,numLines:u,layers:g};return console.log("attributes",l),console.log("traits",c),{attributes:l,traits:c}})(e());let a,i,d,h,u;((t,n={})=>{r("attributes",t),r("traits",n)})(s,n);let g=[];t.setup=()=>{t.getAudioContext().suspend();const r=l();t.createCanvas(...r),t.colorMode(t.HSL);const o=e();a=new p5.Noise("pink"),a.start(),a.amp(0),i=new p5.Env;let s=o.random(1e-4,5e-4),c=o.random(.05,.5),w=o.random(.05,.2);i.setADSR(s,c,.1,w),i.setRange(1,0);let m=[1,0,0,1,0,1,0,0];m=[];const p=o.randomList([8,16]);for(let t=0;t<p;t++)m.push(o.random()<.2?1:0);h=new p5.Phrase("bbox",(function(t,n){i.play(a)}),m),u=new p5.Part,u.addPhrase(h),u.setBPM(60),d=new p5.Amplitude;const f=Math.round(.15*t.width);for(let e=0;e<n.numLines;e++){const n=o.randomInt(f,t.width-f),e=o.randomInt(f,t.height-f);g.push([n,e])}},t.mousePressed=()=>{t.userStartAudio(),u.start()},t.draw=()=>{const e=t.color(n.bgHue,n.bgSaturation,n.bgLightness);t.background(e);let r=d.getLevel(),o=t.map(r,0,.4,0,.2*t.height);const s=Math.round(.15*t.width)/n.layers;for(let e=0;e<n.layers;e++){t.push(),t.translate((e-Math.floor(n.layers/2))*s,0);const r=t.color(n.fgHue,n.fgSaturation*(e/n.layers),n.fgLightness*(e/n.layers));t.fill(r),t.noStroke(),t.beginShape();const a=t.width/2,i=t.height/2;for(let n=0;n<g.length;n++){const e=g[n][0],r=g[n][1],s=(e-a)/a*o,d=(r-i)/i*o;t.curveVertex(e+s,r+d)}t.endShape(),t.pop()}window.previewReady=!0};const l=()=>{let n=t.windowHeight,e=t.windowHeight;return e>t.windowWidth&&(e=t.windowWidth,n=t.windowWidth),[e,n]};t.windowResized=()=>{if("true"!==new URLSearchParams(window.location.search).get("preview")){const n=l();t.resizeCanvas(...n)}}}),document.getElementById("root"))})();